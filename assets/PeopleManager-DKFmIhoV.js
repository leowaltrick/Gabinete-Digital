import{j as e,f as I,D as Ze,i as F,s as b,S as K,P as ze,a as ne}from"./index-CI4IvlJK.js";import{r,G as Ie,a4 as Me,X as Fe,i as et,q as tt,t as st,m as Te,n as at,x as _e,U as ie,j as rt,a0 as lt,$ as ot,ai as Be,k as ce,w as Ae,o as dt}from"./vendor-4jWj67uV.js";import"./db-Csg3uZaR.js";import"./maps-BmSRYpEH.js";const nt=(s,h,p)=>{if(!s||s.length===0){alert("Não há dados para exportar com os filtros atuais.");return}const k="data:text/csv;charset=utf-8,"+"\uFEFF"+[h.join(","),...s.map(d=>d.join(","))].join(`
`),C=encodeURI(k),w=document.createElement("a"),v=new Date,D=v.toLocaleDateString("pt-BR").split("/").reverse().join("-"),S=v.toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"}).replace(":","-");w.setAttribute("href",C),w.setAttribute("download",`${p}_${D}_${S}.csv`),document.body.appendChild(w),w.click(),document.body.removeChild(w)},it=({citizen:s,onClose:h,onEdit:p,onCreateDemand:j,onNotification:k})=>{const[C,w]=r.useState([]),[v,D]=r.useState(!1);r.useEffect(()=>{(async()=>{D(!0);try{if(F()&&b){const{data:f,error:x}=await b.from("demands").select("*").eq("citizen_id",s.id).order("created_at",{ascending:!1});if(f){const N=f.map(o=>({id:o.id,title:o.title,description:o.description,level:o.level,status:o.status,priority:o.priority,type:o.type,deadline:o.deadline,citizenId:o.citizen_id,createdAt:o.created_at,tags:o.tags}));w(N)}}}catch(f){console.error(f)}finally{D(!1)}})()},[s.id]);const S=()=>{if(!s.lat||!s.lon){k&&k("error","Localização não definida.");return}setTimeout(()=>{const c=new CustomEvent("navigate-to-map",{detail:{citizenId:s.id,lat:s.lat,lon:s.lon}});window.dispatchEvent(c)},0),h()},d=c=>{const f=c.replace(/\D/g,"");window.open(`https://wa.me/55${f}`,"_blank")},L=()=>[s.logradouro,s.numero?`Nº ${s.numero}`:null,s.bairro,s.cidade&&s.estado?`${s.cidade} - ${s.estado}`:s.cidade].filter(Boolean).join(", ")||"Endereço não informado";return e.jsxs("div",{className:"fixed inset-0 z-[70] flex items-end md:items-center justify-center sm:p-4",children:[e.jsx("div",{className:"absolute inset-0 bg-slate-900/60 backdrop-blur-md transition-opacity duration-300",onClick:h}),e.jsxs("div",{className:"relative w-full h-full md:h-[90vh] md:max-w-5xl bg-white dark:bg-[#0b1121] md:rounded-3xl shadow-2xl overflow-hidden flex flex-col animate-in slide-in-from-bottom-10 md:zoom-in-95 duration-300 border-t md:border border-slate-200 dark:border-white/10",children:[e.jsxs("div",{className:"px-4 py-3 md:px-8 md:py-5 border-b border-slate-200 dark:border-white/10 flex items-center justify-between bg-white/90 dark:bg-[#0b1121]/90 backdrop-blur-md z-20 shrink-0 sticky top-0",children:[e.jsxs("div",{className:"flex-1 min-w-0 mr-4 flex items-center gap-3",children:[e.jsx("button",{onClick:h,className:"p-1 rounded-lg hover:bg-slate-100 dark:hover:bg-white/10 text-slate-500 dark:text-white transition-colors md:hidden",children:e.jsx(Ie,{className:"w-6 h-6"})}),e.jsx("div",{className:"w-10 h-10 rounded-full bg-brand-100 dark:bg-brand-500/20 flex items-center justify-center text-brand-600 dark:text-brand-400 font-bold text-lg border border-brand-200 dark:border-brand-500/30",children:s.name.charAt(0)}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("h2",{className:"text-lg md:text-2xl font-bold text-slate-900 dark:text-white leading-tight truncate",children:s.name}),s.bairro&&e.jsx("p",{className:"text-xs text-slate-500 dark:text-white/50 truncate",children:s.bairro})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>{p()},className:"p-2 md:p-2.5 text-slate-500 hover:text-brand-600 hover:bg-slate-100 rounded-xl transition-colors dark:text-white/50 dark:hover:text-white dark:hover:bg-white/10",title:"Editar",children:e.jsx(Me,{className:"w-5 h-5"})}),e.jsx("button",{onClick:h,className:"hidden md:block p-2 md:p-2.5 text-slate-400 hover:text-slate-800 hover:bg-slate-100 rounded-full transition-colors dark:text-white/40 dark:hover:text-white dark:hover:bg-white/10",children:e.jsx(Fe,{className:"w-6 h-6"})})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto bg-slate-50/30 dark:bg-black/20 custom-scrollbar p-4 md:p-8",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 max-w-5xl mx-auto",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white dark:bg-white/5 border border-slate-200 dark:border-white/10 rounded-2xl p-5 shadow-sm space-y-4",children:[e.jsxs("h3",{className:"text-xs font-bold uppercase tracking-wider text-slate-500 dark:text-white/60 flex items-center gap-2",children:[e.jsx(et,{className:"w-4 h-4"})," Contato"]}),e.jsxs("div",{className:"space-y-3",children:[s.phone?e.jsxs("div",{className:"flex items-center justify-between p-3 bg-slate-50 dark:bg-white/5 rounded-xl",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-green-100 dark:bg-green-500/20 text-green-600 dark:text-green-400 rounded-lg",children:e.jsx(tt,{className:"w-4 h-4"})}),e.jsx("span",{className:"font-mono text-sm font-bold text-slate-700 dark:text-white",children:I(s.phone)})]}),e.jsx("button",{onClick:()=>d(s.phone),className:"text-xs font-bold text-green-600 hover:underline",children:"WhatsApp"})]}):e.jsx("p",{className:"text-sm text-slate-400 italic",children:"Sem telefone cadastrado."}),s.email&&e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-slate-50 dark:bg-white/5 rounded-xl",children:[e.jsx("div",{className:"p-2 bg-blue-100 dark:bg-blue-500/20 text-blue-600 dark:text-blue-400 rounded-lg",children:e.jsx(st,{className:"w-4 h-4"})}),e.jsx("span",{className:"text-sm font-medium text-slate-700 dark:text-white truncate",children:s.email})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("h3",{className:"text-xs font-bold uppercase tracking-wider text-slate-500 dark:text-white/60 flex items-center gap-2",children:[e.jsx(Te,{className:"w-4 h-4"})," Endereço & Mapa"]}),e.jsxs("div",{className:"bg-white dark:bg-white/5 border border-slate-200 dark:border-white/10 rounded-2xl p-1 shadow-sm",children:[e.jsx("div",{className:"p-4 pb-2",children:e.jsx("p",{className:"text-sm font-medium text-slate-700 dark:text-white leading-relaxed",children:L()})}),e.jsx("div",{className:"p-1",children:e.jsx(Ze,{entityId:s.id,tableName:"citizens",lat:s.lat,lon:s.lon,address:L(),onClick:S})})]})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("button",{onClick:j,className:"w-full py-4 bg-brand-600 hover:bg-brand-500 text-white rounded-2xl font-bold shadow-lg shadow-brand-500/20 flex items-center justify-center gap-2 active:scale-95 transition-all",children:[e.jsx(at,{className:"w-5 h-5"})," Nova Demanda"]}),e.jsxs("div",{className:"bg-white dark:bg-white/5 border border-slate-200 dark:border-white/10 rounded-2xl p-5 shadow-sm flex flex-col h-[400px]",children:[e.jsxs("h3",{className:"text-xs font-bold uppercase tracking-wider text-slate-500 dark:text-white/60 flex items-center gap-2 mb-4",children:[e.jsx(_e,{className:"w-4 h-4"})," Histórico (",C.length,")"]}),e.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar space-y-3 pr-2",children:C.length>0?C.map(c=>e.jsxs("div",{className:"p-3 rounded-xl bg-slate-50 dark:bg-white/5 border border-slate-100 dark:border-white/5",children:[e.jsxs("div",{className:"flex justify-between items-start mb-1",children:[e.jsxs("span",{className:"text-[10px] font-bold text-slate-400",children:["#",c.id.slice(0,6)]}),e.jsx("span",{className:`text-[10px] px-1.5 py-0.5 rounded font-bold uppercase ${c.status==="Concluído"?"bg-green-100 text-green-700":"bg-slate-200 text-slate-600"}`,children:c.status})]}),e.jsx("p",{className:"text-sm font-bold text-slate-800 dark:text-white line-clamp-1",children:c.title}),e.jsx("p",{className:"text-xs text-slate-500 dark:text-white/50 mt-1",children:new Date(c.createdAt).toLocaleDateString()})]},c.id)):e.jsx("div",{className:"flex flex-col items-center justify-center h-full text-slate-400",children:e.jsx("p",{className:"text-sm italic",children:"Nenhuma demanda registrada."})})})]})]})]})})]})]})},ut=({isModalMode:s=!1,onSelectPerson:h,initialSearchTerm:p,initialMode:j="list",onCreateDemand:k,onEditDemand:C,onUpdateStatus:w,onModeChange:v,onInteractionUpdate:D,onPersonUpdate:S,onNotification:d,permissions:L,onClearSelection:c,demands:f=[]})=>{const[x,N]=r.useState("list"),[o,T]=r.useState(null),[g,X]=r.useState([]),[E,J]=r.useState(""),[Ue,xe]=r.useState(!1),[Q,me]=r.useState(1),_=10,[$,U]=r.useState(!1),[P,He]=r.useState(!1),[he,Y]=r.useState(""),[be,Z]=r.useState(""),[ue,H]=r.useState(""),[pe,y]=r.useState([]),[q,z]=r.useState(""),[M,ee]=r.useState(""),[qe,fe]=r.useState(!1),[ge,O]=r.useState(""),[we,te]=r.useState(""),[je,se]=r.useState(""),[ke,R]=r.useState(""),[ve,V]=r.useState(""),[Ne,W]=r.useState(""),[ct,ye]=r.useState(!1),[Ce,Se]=r.useState(!1),[B,ae]=r.useState(null),[re,le]=r.useState(null),oe=L?L.canCreateCitizen:!0;r.useEffect(()=>{v&&v(x)},[x,v]),r.useEffect(()=>{j&&j!=="list"&&j==="form"&&x!=="form"&&Le()},[j]),r.useEffect(()=>{p?(async()=>{const l=ne(p);if(F()&&b){const{data:a}=await b.from("citizens").select("*").eq("telefone",l).maybeSingle();a?(X([a]),de(a)):(J(p),N("list"))}})():x==="list"&&Ee()},[p]),r.useEffect(()=>{x==="list"&&!p&&g.length===0&&Ee()},[x]);const Ee=async()=>{xe(!0);try{if(F()&&b){const{data:t,error:l}=await b.from("citizens").select("*").order("created_at",{ascending:!1}).limit(1e3);if(l)throw l;t&&X(t)}}catch(t){console.error("Erro ao buscar pessoas:",t)}finally{xe(!1)}},De=()=>{Y(""),Z(""),H(""),y([]),z(""),ee(""),O(""),te(""),se(""),R(""),V(""),W(""),ae(null),U(!1),le(null)},Le=()=>{if(!oe){d&&d("error","Sem permissão para criar cidadãos.");return}De(),U(!1),N("form")},$e=()=>{De(),T(null),N("list"),c&&c()},de=t=>{if(s&&h){h(t);return}T(t)},Oe=()=>{if(o){if(!oe){d&&d("error","Sem permissão para editar.");return}Y(o.nome||""),Z(o.sobrenome||""),H(o.email||""),z(I(o.telefone||"")),ee(o.cep||""),O(o.logradouro||""),te(o.numero||""),se(o.complemento||""),R(o.bairro||""),V(o.cidade||""),W(o.estado||""),ae(o),U(!0),N("form"),T(null)}},Re=async()=>{if($)return;const t=ne(q);if(t){if(t.length<10){le("Telefone inválido");return}ye(!0);try{if(F()&&b){const{data:l}=await b.from("citizens").select("*").eq("telefone",t).maybeSingle();l&&(ae(l),d&&d("error","Este telefone já possui cadastro."))}}catch(l){console.error(l)}finally{ye(!1)}}},Ve=async()=>{const t=M.replace(/\D/g,"");if(t.length===8){fe(!0);try{const a=await(await fetch(`https://viacep.com.br/ws/${t}/json/`)).json();a.erro||(O(a.logradouro),R(a.bairro),V(a.localidade),W(a.uf))}catch(l){console.error(l)}finally{fe(!1)}}},We=t=>{if(H(t),!t){y([]);return}const l=["gmail.com","hotmail.com","outlook.com","yahoo.com.br","icloud.com"];if(l.some(a=>t.endsWith("@"+a))){y([]);return}if(!t.includes("@"))y(l.map(a=>`${t}@${a}`));else{const[a,i]=t.split("@"),m=l.filter(n=>n.startsWith(i));m.length>0?y(m.map(n=>`${a}@${n}`)):y([])}},Ge=t=>{H(t),y([])},Ke=async t=>{t.preventDefault();const l=q?ne(q):null;if(!l){le("É necessário informar o Telefone."),d&&d("error","Informe o Telefone.");return}Se(!0);const a={nome:he,sobrenome:be,email:ue||null,telefone:l,cep:M.replace(/\D/g,""),logradouro:ge,numero:we,complemento:je||null,bairro:ke,cidade:ve,estado:Ne.substring(0,2).toUpperCase()};try{if(F()&&b){let i;if($&&(B!=null&&B.id)){const{data:n,error:u}=await b.from("citizens").update(a).eq("id",B.id).select().single();if(u)throw u;i=n,d&&d("success","Dados atualizados!")}else{const{data:n,error:u}=await b.from("citizens").insert(a).select().single();if(u)throw u;i=n,d&&d("success","Cidadão cadastrado!")}S&&S();const m=$?g.map(n=>n.id===i.id?i:n):[i,...g];X(m),s&&h?h(i):(N("list"),U(!1))}else d&&d("error","Erro de conexão.")}catch(i){d&&d("error",`Erro: ${i.message}`)}finally{Se(!1)}},A=r.useMemo(()=>g.filter(t=>{const l=E.toLowerCase(),a=`${t.nome} ${t.sobrenome}`.toLowerCase(),i=t.telefone?t.telefone.replace(/\D/g,""):"",m=E.replace(/\D/g,""),n=a.includes(l)||m.length>3&&i.includes(m)||t.email&&t.email.toLowerCase().includes(l);let u=!0;return P&&(u=f.some(Ye=>Ye.citizenId===t.id)),n&&u}),[g,E,P,f]),G=r.useMemo(()=>{const t=g.length,l=new Date().toDateString(),a=g.filter(n=>n.created_at&&new Date(n.created_at).toDateString()===l).length,i={};g.forEach(n=>{n.bairro&&(i[n.bairro]=(i[n.bairro]||0)+1)});const m=Object.entries(i).sort((n,u)=>u[1]-n[1])[0];return{total:t,newToday:a,topBairro:m?m[0]:"N/A",topBairroCount:m?m[1]:0}},[g]);r.useEffect(()=>{me(1)},[E,P]);const Xe=Math.ceil(A.length/_),Pe=A.slice((Q-1)*_,Q*_),Je=()=>{const t=["Nome","Sobrenome","Telefone","Email","Logradouro","Número","Bairro","Cidade","UF","CEP","Data Cadastro"],l=A.map(a=>[`"${a.nome}"`,`"${a.sobrenome}"`,a.telefone||"",a.email||"",`"${a.logradouro}"`,a.numero,`"${a.bairro}"`,`"${a.cidade}"`,a.estado,a.cep,a.created_at?new Date(a.created_at).toLocaleDateString():""]);nt(l,t,"Cidadaos")},Qe=t=>({id:t.id||"temp",cpf:t.cpf,name:`${t.nome} ${t.sobrenome}`,email:t.email||"",phone:t.telefone||"",createdAt:t.created_at,logradouro:t.logradouro,numero:t.numero,complemento:t.complemento||void 0,bairro:t.bairro,cep:t.cep,cidade:t.cidade,estado:t.estado,lat:t.lat,lon:t.lon});return e.jsxs("div",{className:`flex flex-col gap-4 animate-in slide-in-from-right duration-500 ${s?"p-0":""} relative w-full min-w-0 pb-20 md:pb-0`,children:[e.jsx("div",{className:"shrink-0 flex flex-col gap-4",children:e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[x!=="list"&&!s&&e.jsxs("button",{onClick:$e,className:"p-2 rounded-full hover:bg-slate-100 dark:hover:bg-white/10 transition-colors mr-1",children:[" ",e.jsx(Ie,{className:"w-6 h-6 text-slate-600 dark:text-white"})," "]}),!s&&e.jsx("div",{children:e.jsxs("h1",{className:"text-3xl font-bold text-slate-900 dark:text-white tracking-tight flex items-center gap-3",children:[e.jsx(ie,{className:"w-8 h-8 text-brand-600 dark:text-brand-400"}),"Gestão de Cidadãos"]})})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-center gap-3 w-full md:w-auto",children:[x==="list"&&!s&&e.jsx("div",{className:"flex items-center gap-2 w-full sm:w-auto",children:e.jsxs("div",{className:"relative w-full md:w-[280px] group",children:[e.jsx("input",{type:"text",value:E,onChange:t=>J(t.target.value),placeholder:"Buscar por nome ou telefone...",className:"w-full pl-11 pr-10 py-3 bg-slate-50 dark:bg-black/20 border border-slate-200 dark:border-white/10 rounded-xl outline-none focus:border-brand-500 focus:bg-white dark:focus:bg-black/20 transition-all font-medium text-slate-700 dark:text-white placeholder:text-slate-400 h-11 text-sm"}),e.jsx(rt,{className:"w-5 h-5 text-slate-400 absolute left-3.5 top-3 group-focus-within:text-brand-500 transition-colors"}),E&&e.jsx("button",{onClick:()=>J(""),className:"absolute right-3 top-3 text-slate-400 hover:text-slate-600 dark:hover:text-white",children:e.jsx(Fe,{className:"w-5 h-5"})})]})}),e.jsxs("div",{className:"flex items-center gap-3 w-full sm:w-auto",children:[x==="list"&&!s&&e.jsxs("button",{onClick:()=>He(!P),className:`w-auto px-4 py-2.5 rounded-xl font-bold border transition-all flex items-center justify-center gap-2 h-11 text-sm ${P?"bg-brand-50 border-brand-200 text-brand-700 dark:bg-brand-500/20 dark:border-brand-500/30 dark:text-brand-300":"bg-white dark:bg-white/5 text-slate-600 dark:text-white/70 border-slate-200 dark:border-white/10 hover:bg-slate-50 dark:hover:bg-white/10"}`,title:"Apenas com Demandas",children:[e.jsx(lt,{className:"w-4 h-4"})," ",e.jsx("span",{className:"hidden sm:inline",children:"Com Demandas"})]}),x==="list"&&!s&&e.jsx("button",{onClick:Je,className:"w-auto px-4 py-2.5 rounded-xl font-bold bg-white dark:bg-white/5 text-slate-600 dark:text-white/70 border border-slate-200 dark:border-white/10 hover:bg-slate-50 dark:hover:bg-white/10 transition-all flex items-center justify-center gap-2 h-11",title:"Exportar CSV",children:e.jsx(ot,{className:"w-5 h-5"})}),x==="list"&&oe&&e.jsxs("button",{onClick:Le,className:"w-full sm:w-auto px-5 py-2.5 bg-brand-600 hover:bg-brand-500 text-white rounded-xl font-bold shadow-lg shadow-brand-500/20 transition-all flex items-center justify-center gap-2 active:scale-95 duration-200 h-11",children:[e.jsx(Be,{className:"w-5 h-5"})," ",e.jsx("span",{className:"whitespace-nowrap",children:"Novo Cidadão"})]})]})]})]})}),e.jsxs("div",{className:"flex flex-col min-h-0 w-full relative",children:[x==="list"&&e.jsxs("div",{className:"flex flex-col gap-4 w-full",children:[!s&&e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 md:gap-4 shrink-0",children:[" ",e.jsx(K,{title:"Total Cidadãos",value:G.total,icon:ie,colorClass:"bg-blue-500",textClass:"text-blue-600 dark:text-blue-400"})," ",e.jsx(K,{title:"Novos Hoje",value:G.newToday,icon:Be,colorClass:"bg-green-500",textClass:"text-green-600 dark:text-green-400"})," ",e.jsx(K,{title:"Top Bairro",value:G.topBairro,icon:Te,colorClass:"bg-brand-500",textClass:"text-brand-600 dark:text-brand-400"})," ",e.jsx(K,{title:"Cadastros (Bairro)",value:G.topBairroCount,icon:_e,colorClass:"bg-purple-500",textClass:"text-purple-600 dark:text-purple-400"})," "]}),e.jsx("div",{className:"flex flex-col min-h-0 glass-panel rounded-3xl border border-slate-200 dark:border-white/10 bg-white/50 dark:bg-slate-900/50 shadow-sm relative w-full",children:Ue?e.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center text-slate-400 dark:text-white/40 py-20",children:[e.jsx(ce,{className:"w-8 h-8 animate-spin mb-2 text-brand-500"}),e.jsx("p",{children:"Carregando..."})]}):A.length===0?e.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center text-slate-400 dark:text-white/40 py-20",children:[e.jsx(ie,{className:"w-12 h-12 mb-2 opacity-20"}),e.jsx("p",{children:"Nenhum cidadão encontrado."})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"w-full relative",children:[e.jsxs("table",{className:"w-full text-left border-collapse hidden md:table",children:[e.jsxs("thead",{className:"bg-slate-50/90 dark:bg-slate-900/90 backdrop-blur-sm border-b border-slate-200 dark:border-white/10",children:[" ",e.jsxs("tr",{className:"text-xs font-bold text-slate-500 dark:text-blue-200/50 uppercase tracking-wider",children:[" ",e.jsx("th",{className:"p-4 first:pl-6 w-[45%] min-w-[200px]",children:"Cidadão"})," ",e.jsx("th",{className:"p-4 w-[20%] whitespace-nowrap",children:"Contato"})," ",e.jsx("th",{className:"p-4 w-[25%] min-w-[150px]",children:"Localização"})," ",e.jsx("th",{className:"p-4 text-right last:pr-6 w-[10%]",children:"Ação"})," "]})," "]}),e.jsxs("tbody",{className:"divide-y divide-slate-200 dark:divide-white/5 text-sm",children:[" ",Pe.map((t,l)=>e.jsxs("tr",{onClick:()=>de(t),className:"hover:bg-white/60 dark:hover:bg-white/5 transition-colors cursor-pointer group",children:[" ",e.jsxs("td",{className:"p-4 first:pl-6",children:[" ",e.jsxs("div",{className:"flex items-center gap-3",children:[" ",e.jsx("div",{className:"w-9 h-9 rounded-full bg-slate-100 dark:bg-white/10 flex items-center justify-center text-slate-600 dark:text-white font-bold text-xs border border-slate-200 dark:border-white/10 shrink-0",children:t.nome.charAt(0)})," ",e.jsxs("div",{className:"min-w-0",children:[e.jsxs("div",{className:"font-bold text-slate-900 dark:text-white truncate",children:[t.nome," ",t.sobrenome]}),e.jsx("div",{className:"text-xs text-slate-500 dark:text-white/50 truncate",children:t.email||""})]})," "]})," "]})," ",e.jsx("td",{className:"p-4 text-slate-600 dark:text-white/80 whitespace-nowrap",children:t.telefone?I(t.telefone):"-"})," ",e.jsx("td",{className:"p-4 text-slate-600 dark:text-white/80",children:t.bairro?e.jsxs("span",{className:"flex flex-col",children:[e.jsx("span",{className:"truncate",children:t.bairro}),e.jsxs("span",{className:"text-[10px] text-slate-400 truncate",children:[t.cidade,"/",t.estado]})]}):"-"})," ",e.jsx("td",{className:"p-4 text-right last:pr-6",children:e.jsx("div",{className:"p-2 text-slate-400 group-hover:text-brand-600 transition-colors inline-flex bg-slate-100 dark:bg-white/5 rounded-lg group-hover:bg-brand-50 dark:group-hover:bg-brand-500/10",children:s?e.jsx("span",{className:"px-3 py-1 bg-brand-500 text-white text-xs font-bold rounded-lg shadow-sm",children:"Selecionar"}):e.jsx(Ae,{className:"w-4 h-4"})})})," "]},t.id||l))," "]})]}),e.jsx("div",{className:"md:hidden space-y-3 p-3",children:Pe.map((t,l)=>e.jsxs("div",{onClick:()=>de(t),className:"glass-panel p-4 rounded-2xl border border-slate-200 dark:border-white/10 shadow-sm active:scale-[0.98] transition-all cursor-pointer flex items-center justify-between min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-slate-100 dark:bg-white/10 flex items-center justify-center font-bold text-lg text-slate-600 dark:text-white border border-slate-200 dark:border-white/10 shrink-0",children:t.nome.charAt(0)}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsxs("p",{className:"font-bold text-slate-900 dark:text-white truncate text-base",children:[t.nome," ",t.sobrenome]}),e.jsxs("div",{className:"flex flex-col gap-0.5 text-xs text-slate-500 dark:text-white/50 mt-0.5",children:[e.jsx("span",{className:"font-mono",children:t.telefone?I(t.telefone):"Sem Telefone"}),e.jsx("span",{className:"truncate flex items-center gap-1",children:t.bairro||"Sem Bairro"})]})]})]}),e.jsxs("div",{className:"text-slate-400 group-hover:text-brand-600 transition-colors shrink-0 ml-2",children:[" ",s?e.jsx("span",{className:"px-3 py-1 bg-brand-500 text-white text-xs font-bold rounded-lg shadow-sm",children:"OK"}):e.jsx(Ae,{className:"w-5 h-5"})," "]})]},t.id||l))})]}),e.jsxs("div",{className:"shrink-0 bg-slate-50/50 dark:bg-slate-900/50 border-t border-slate-200 dark:border-white/5 z-20",children:[" ",e.jsx(ze,{currentPage:Q,totalPages:Xe,onPageChange:me,totalItems:A.length,itemsPerPage:_})," "]})," "]})})]}),x==="form"&&e.jsx("div",{className:"w-full",children:e.jsxs("div",{className:"glass-panel p-4 md:p-8 rounded-3xl border border-slate-200 dark:border-white/10 max-w-3xl mx-auto w-full animate-in fade-in slide-in-from-bottom-4 mb-20 md:mb-0",children:[e.jsxs("div",{className:"text-center mb-8",children:[" ",e.jsx("h2",{className:"text-2xl font-bold text-slate-900 dark:text-white mb-2",children:$?"Editar Cadastro":"Novo Cidadão"})," ",e.jsx("p",{className:"text-slate-500 dark:text-white/50",children:"Preencha os dados do munícipe."})," "]}),e.jsxs("form",{onSubmit:Ke,className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-xs font-bold uppercase tracking-wider text-slate-400 dark:text-white/40 border-b border-slate-200 dark:border-white/10 pb-2 mb-4",children:"Identificação"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold uppercase text-slate-500 dark:text-white/50 mb-1",children:"Nome"}),e.jsx("input",{type:"text",value:he,onChange:t=>Y(t.target.value),className:"w-full p-3 rounded-xl border border-slate-300 dark:border-white/10 glass-input outline-none focus:border-brand-500",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold uppercase text-slate-500 dark:text-white/50 mb-1",children:"Sobrenome"}),e.jsx("input",{type:"text",value:be,onChange:t=>Z(t.target.value),className:"w-full p-3 rounded-xl border border-slate-300 dark:border-white/10 glass-input outline-none focus:border-brand-500",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold uppercase text-slate-500 dark:text-white/50 mb-1",children:"Telefone (Obrigatório)"}),e.jsx("input",{type:"text",value:q,onChange:t=>z(I(t.target.value)),onBlur:Re,className:`w-full p-3 rounded-xl border ${re?"border-red-500":"border-slate-300 dark:border-white/10"} glass-input outline-none focus:border-brand-500`,placeholder:"(00) 00000-0000"}),re&&e.jsx("p",{className:"text-xs text-red-500 mt-1",children:re})]}),e.jsxs("div",{className:"relative",children:[e.jsx("label",{className:"block text-xs font-bold uppercase text-slate-500 dark:text-white/50 mb-1",children:"Email (Opcional)"}),e.jsx("input",{type:"email",value:ue,onChange:t=>We(t.target.value),className:"w-full p-3 rounded-xl border border-slate-300 dark:border-white/10 glass-input outline-none focus:border-brand-500",placeholder:"exemplo@email.com",autoComplete:"off"}),pe.length>0&&e.jsx("div",{className:"absolute top-full left-0 right-0 mt-1 bg-white dark:bg-slate-900 border border-slate-200 dark:border-white/10 rounded-xl shadow-lg z-50 overflow-hidden animate-in fade-in zoom-in-95",children:pe.map(t=>e.jsx("button",{type:"button",onClick:()=>Ge(t),className:"w-full text-left px-4 py-2 text-sm text-slate-700 dark:text-white hover:bg-slate-50 dark:hover:bg-white/10 transition-colors",children:t},t))})]})]})]}),e.jsxs("div",{className:"space-y-4 pt-4 border-t border-slate-100 dark:border-white/5",children:[e.jsx("h3",{className:"text-xs font-bold uppercase tracking-wider text-slate-400 dark:text-white/40 border-b border-slate-200 dark:border-white/10 pb-2 mb-4",children:"Endereço"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"md:col-span-1",children:[e.jsx("label",{className:"block text-xs font-bold uppercase text-slate-500 dark:text-white/50 mb-1",children:"CEP"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",value:M,onChange:t=>ee(t.target.value),onBlur:Ve,className:"w-full p-3 rounded-xl border border-slate-300 dark:border-white/10 glass-input outline-none focus:border-brand-500",placeholder:"00000-000"}),qe&&e.jsx(ce,{className:"absolute right-3 top-3 w-5 h-5 text-brand-500 animate-spin"})]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-xs font-bold uppercase text-slate-500 dark:text-white/50 mb-1",children:"Logradouro"}),e.jsx("input",{type:"text",value:ge,onChange:t=>O(t.target.value),className:"w-full p-3 rounded-xl border border-slate-300 dark:border-white/10 glass-input outline-none focus:border-brand-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold uppercase text-slate-500 dark:text-white/50 mb-1",children:"Número"}),e.jsx("input",{type:"text",value:we,onChange:t=>te(t.target.value),className:"w-full p-3 rounded-xl border border-slate-300 dark:border-white/10 glass-input outline-none focus:border-brand-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold uppercase text-slate-500 dark:text-white/50 mb-1",children:"Complemento"}),e.jsx("input",{type:"text",value:je,onChange:t=>se(t.target.value),className:"w-full p-3 rounded-xl border border-slate-300 dark:border-white/10 glass-input outline-none focus:border-brand-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold uppercase text-slate-500 dark:text-white/50 mb-1",children:"Bairro"}),e.jsx("input",{type:"text",value:ke,onChange:t=>R(t.target.value),className:"w-full p-3 rounded-xl border border-slate-300 dark:border-white/10 glass-input outline-none focus:border-brand-500"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold uppercase text-slate-500 dark:text-white/50 mb-1",children:"Cidade"}),e.jsx("input",{type:"text",value:ve,onChange:t=>V(t.target.value),className:"w-full p-3 rounded-xl border border-slate-300 dark:border-white/10 glass-input outline-none focus:border-brand-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold uppercase text-slate-500 dark:text-white/50 mb-1",children:"UF"}),e.jsx("input",{type:"text",value:Ne,onChange:t=>W(t.target.value),className:"w-full p-3 rounded-xl border border-slate-300 dark:border-white/10 glass-input outline-none focus:border-brand-500 uppercase",maxLength:2})]})]})]})]}),e.jsxs("div",{className:"fixed bottom-0 left-0 right-0 p-4 bg-white/95 dark:bg-[#0b1121]/95 backdrop-blur-md border-t border-slate-200 dark:border-white/10 z-30 flex gap-3 md:static md:bg-transparent md:p-0 md:border-0 pb-6",children:[e.jsx("button",{type:"button",onClick:$e,className:"px-6 py-3 rounded-xl border border-slate-200 dark:border-white/10 text-slate-500 dark:text-white/60 hover:bg-slate-50 dark:hover:bg-white/5 font-bold flex-1 active:scale-95 duration-200 transition-transform",children:"Cancelar"}),e.jsxs("button",{type:"submit",disabled:Ce||!!B&&!$,className:"px-6 py-3 bg-brand-600 hover:bg-brand-500 text-white rounded-xl font-bold shadow-lg shadow-brand-500/20 flex-1 flex items-center justify-center gap-2 disabled:opacity-50 active:scale-95 duration-200 transition-transform",children:[Ce?e.jsx(ce,{className:"w-5 h-5 animate-spin"}):e.jsx(dt,{className:"w-5 h-5"})," Salvar"]})]})]})]})})]}),o&&!s&&e.jsx(it,{citizen:Qe(o),onClose:()=>T(null),onEdit:Oe,onCreateDemand:()=>k&&k(o.id||""),onNotification:d})]})};export{ut as default};
