import{j as e,f as O,D as Qe,i as L,s as x,a as Ae,S as M,P as Ye,b as U}from"./index-CFS8kr30.js";import{r as s,J as Fe,a6 as Ze,X as ze,i as et,q as tt,t as at,aq as Te,m as _e,n as st,y as rt,U as de,k as W,j as $e,o as lt,a1 as dt,ak as Be,a2 as ot,F as Ie,x as nt}from"./vendor-DXGv6lL1.js";import"./db-CGtpfmbJ.js";import"./maps-DpZc8L4w.js";const it=(a,m,b)=>{if(!a||a.length===0){alert("Não há dados para exportar com os filtros atuais.");return}const w="data:text/csv;charset=utf-8,"+"\uFEFF"+[m.join(","),...a.map(o=>o.join(","))].join(`
`),k=encodeURI(w),h=document.createElement("a"),f=new Date,R=f.toLocaleDateString("pt-BR").split("/").reverse().join("-"),j=f.toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"}).replace(":","-");h.setAttribute("href",k),h.setAttribute("download",`${b}_${R}_${j}.csv`),document.body.appendChild(h),h.click(),document.body.removeChild(h)},ct=({citizen:a,onClose:m,onEdit:b,onCreateDemand:g,onNotification:w,onSelectDemand:k})=>{const[h,f]=s.useState([]),[R,j]=s.useState(!1);s.useEffect(()=>{(async()=>{j(!0);try{if(L()&&x){const{data:c,error:v}=await x.from("demands").select("*").eq("citizen_id",a.id).order("created_at",{ascending:!1});if(c){const l=c.map(i=>({id:i.id,title:i.title,description:i.description,level:i.level,status:i.status,priority:i.priority,type:i.type,deadline:i.deadline,citizenId:i.citizen_id,createdAt:i.created_at,tags:i.tags}));f(l)}}}catch(c){console.error(c)}finally{j(!1)}})()},[a.id]);const o=()=>{if(!a.lat||!a.lon){w&&w("error","Localização não definida.");return}setTimeout(()=>{const n=new CustomEvent("navigate-to-map",{detail:{citizenId:a.id,lat:a.lat,lon:a.lon}});window.dispatchEvent(n)},0),m()},D=n=>{const c=n.replace(/\D/g,"");window.open(`https://wa.me/55${c}`,"_blank")},E=()=>[a.logradouro,a.numero?`Nº ${a.numero}`:null,a.bairro,a.cidade&&a.estado?`${a.cidade} - ${a.estado}`:a.cidade].filter(Boolean).join(", ")||"Endereço não informado";return e.jsxs("div",{className:"fixed inset-0 z-[70] flex items-end md:items-center justify-center sm:p-4",children:[e.jsx("div",{className:"absolute inset-0 bg-slate-900/60 backdrop-blur-md transition-opacity duration-300",onClick:m}),e.jsxs("div",{className:"relative w-full h-full md:h-[90vh] md:max-w-5xl bg-white dark:bg-[#0b1121] md:rounded-3xl shadow-2xl overflow-hidden flex flex-col animate-in slide-in-from-bottom-10 md:zoom-in-95 duration-300 border-t md:border border-slate-200 dark:border-white/10",children:[e.jsxs("div",{className:"px-4 py-3 md:px-8 md:py-5 border-b border-slate-200 dark:border-white/10 flex items-center justify-between bg-white/90 dark:bg-[#0b1121]/90 backdrop-blur-md z-20 shrink-0 sticky top-0",children:[e.jsxs("div",{className:"flex-1 min-w-0 mr-4 flex items-center gap-3",children:[e.jsx("button",{onClick:m,className:"p-1 rounded-lg hover:bg-slate-100 dark:hover:bg-white/10 text-slate-500 dark:text-white transition-colors md:hidden",children:e.jsx(Fe,{className:"w-6 h-6"})}),e.jsx("div",{className:"w-10 h-10 rounded-full bg-brand-100 dark:bg-brand-500/20 flex items-center justify-center text-brand-600 dark:text-brand-400 font-bold text-lg border border-brand-200 dark:border-brand-500/30",children:a.name.charAt(0)}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("h2",{className:"text-lg md:text-2xl font-bold text-slate-900 dark:text-white leading-tight truncate",children:a.name}),a.bairro&&e.jsx("p",{className:"text-xs text-slate-500 dark:text-white/50 truncate",children:a.bairro})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>{b()},className:"p-2 md:p-2.5 text-slate-500 hover:text-brand-600 hover:bg-slate-100 rounded-xl transition-colors dark:text-white/50 dark:hover:text-white dark:hover:bg-white/10",title:"Editar",children:e.jsx(Ze,{className:"w-5 h-5"})}),e.jsx("button",{onClick:m,className:"hidden md:block p-2 md:p-2.5 text-slate-400 hover:text-slate-800 hover:bg-slate-100 rounded-full transition-colors dark:text-white/40 dark:hover:text-white dark:hover:bg-white/10",children:e.jsx(ze,{className:"w-6 h-6"})})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto bg-slate-50/30 dark:bg-black/20 custom-scrollbar p-4 md:p-8",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 max-w-5xl mx-auto",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white dark:bg-white/5 border border-slate-200 dark:border-white/10 rounded-2xl p-5 shadow-sm space-y-4",children:[e.jsxs("h3",{className:"text-xs font-bold uppercase tracking-wider text-slate-500 dark:text-white/60 flex items-center gap-2",children:[e.jsx(et,{className:"w-4 h-4"})," Contato"]}),e.jsxs("div",{className:"space-y-3",children:[a.phone?e.jsxs("div",{className:"flex items-center justify-between p-3 bg-slate-50 dark:bg-white/5 rounded-xl",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-green-100 dark:bg-green-500/20 text-green-600 dark:text-green-400 rounded-lg",children:e.jsx(tt,{className:"w-4 h-4"})}),e.jsx("span",{className:"font-mono text-sm font-bold text-slate-700 dark:text-white",children:O(a.phone)})]}),e.jsx("button",{onClick:()=>D(a.phone),className:"text-xs font-bold text-green-600 hover:underline",children:"WhatsApp"})]}):e.jsx("p",{className:"text-sm text-slate-400 italic",children:"Sem telefone cadastrado."}),a.email&&e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-slate-50 dark:bg-white/5 rounded-xl",children:[e.jsx("div",{className:"p-2 bg-blue-100 dark:bg-blue-500/20 text-blue-600 dark:text-blue-400 rounded-lg",children:e.jsx(at,{className:"w-4 h-4"})}),e.jsx("span",{className:"text-sm font-medium text-slate-700 dark:text-white truncate",children:a.email})]})]})]}),e.jsxs("div",{className:"bg-white dark:bg-white/5 border border-slate-200 dark:border-white/10 rounded-2xl p-5 shadow-sm space-y-3",children:[e.jsxs("h3",{className:"text-xs font-bold uppercase tracking-wider text-slate-500 dark:text-white/60 flex items-center gap-2",children:[e.jsx(Te,{className:"w-4 h-4"})," Observações"]}),e.jsx("div",{className:"p-4 bg-slate-50 dark:bg-white/5 rounded-xl min-h-[80px]",children:a.observacoes?e.jsx("p",{className:"text-sm text-slate-700 dark:text-white leading-relaxed whitespace-pre-wrap",children:a.observacoes}):e.jsx("p",{className:"text-sm text-slate-400 italic",children:"Nenhuma observação registrada."})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("h3",{className:"text-xs font-bold uppercase tracking-wider text-slate-500 dark:text-white/60 flex items-center gap-2",children:[e.jsx(_e,{className:"w-4 h-4"})," Endereço & Mapa"]}),e.jsxs("div",{className:"bg-white dark:bg-white/5 border border-slate-200 dark:border-white/10 rounded-2xl p-1 shadow-sm",children:[e.jsx("div",{className:"p-4 pb-2",children:e.jsx("p",{className:"text-sm font-medium text-slate-700 dark:text-white leading-relaxed",children:E()})}),e.jsx("div",{className:"p-1",children:e.jsx(Qe,{entityId:a.id,tableName:"citizens",lat:a.lat,lon:a.lon,address:E(),onClick:o})})]})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("button",{onClick:g,className:"w-full py-4 bg-brand-600 hover:bg-brand-500 text-white rounded-2xl font-bold shadow-lg shadow-brand-500/20 flex items-center justify-center gap-2 active:scale-95 transition-all",children:[e.jsx(st,{className:"w-5 h-5"})," Nova Demanda"]}),e.jsxs("div",{className:"bg-white dark:bg-white/5 border border-slate-200 dark:border-white/10 rounded-2xl p-5 shadow-sm flex flex-col h-[400px]",children:[e.jsxs("h3",{className:"text-xs font-bold uppercase tracking-wider text-slate-500 dark:text-white/60 flex items-center gap-2 mb-4",children:[e.jsx(rt,{className:"w-4 h-4"})," Histórico (",h.length,")"]}),e.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar space-y-3 pr-2",children:h.length>0?h.map(n=>e.jsxs("div",{onClick:()=>k&&k(n),className:"p-3 rounded-xl bg-slate-50 dark:bg-white/5 border border-slate-100 dark:border-white/5 cursor-pointer hover:bg-slate-100 dark:hover:bg-white/10 hover:border-brand-200 transition-all group",children:[e.jsxs("div",{className:"flex justify-between items-start mb-1",children:[e.jsxs("span",{className:"text-[10px] font-bold text-slate-400 group-hover:text-brand-500 transition-colors",children:["#",n.id.slice(0,6)]}),e.jsx("span",{className:`text-[10px] px-1.5 py-0.5 rounded font-bold uppercase ${n.status==="Concluído"?"bg-green-100 text-green-700":"bg-slate-200 text-slate-600"}`,children:n.status})]}),e.jsx("p",{className:"text-sm font-bold text-slate-800 dark:text-white line-clamp-1 group-hover:text-brand-600 transition-colors",children:n.title}),e.jsx("p",{className:"text-xs text-slate-500 dark:text-white/50 mt-1",children:new Date(n.createdAt).toLocaleDateString()})]},n.id)):e.jsx("div",{className:"flex flex-col items-center justify-center h-full text-slate-400",children:e.jsx("p",{className:"text-sm italic",children:"Nenhuma demanda registrada."})})})]})]})]})})]})]})},ut=({isModalMode:a=!1,onSelectPerson:m,initialSearchTerm:b,initialMode:g="list",onCreateDemand:w,onEditDemand:k,onUpdateStatus:h,onModeChange:f,onInteractionUpdate:R,onPersonUpdate:j,onNotification:o,permissions:D,onClearSelection:E,demands:n=[]})=>{const[c,v]=s.useState("list"),[l,i]=s.useState(null),[N,oe]=s.useState([]),[V,ne]=s.useState(""),[qe,ie]=s.useState(!1),[J,He]=s.useState(1),P=10,[A,X]=s.useState(!1),[G,Me]=s.useState(!1),[ce,K]=s.useState(""),[xe,Q]=s.useState(""),[he,$]=s.useState(""),[me,y]=s.useState([]),[B,Y]=s.useState(""),[I,Z]=s.useState(""),[Ue,be]=s.useState(!1),[ue,F]=s.useState(""),[pe,z]=s.useState(""),[fe,ee]=s.useState(""),[ge,T]=s.useState(""),[we,_]=s.useState(""),[ke,q]=s.useState(""),[je,te]=s.useState(""),[We,ve]=s.useState(!1),[Ne,ye]=s.useState(!1),[H,ae]=s.useState(null),[Ce,C]=s.useState(null),Se=D?D.canCreateCitizen:!0;s.useEffect(()=>{f&&f(c)},[c,f]),s.useEffect(()=>{g&&g!=="list"&&g==="form"&&c!=="form"&&Le()},[g]),s.useEffect(()=>{b?(async()=>{const r=U(b);if(L()&&x){const{data:d}=await x.from("citizens").select("*").eq("telefone",r).maybeSingle();d?(oe([d]),De(d)):(ne(b),v("list"))}})():c==="list"&&se()},[b]),s.useEffect(()=>{c==="list"&&!b&&N.length===0&&se()},[c]);const se=async()=>{ie(!0);try{if(L()&&x){const{data:t,error:r}=await x.from("citizens").select("*").order("created_at",{ascending:!1}).limit(1e3);if(r)throw r;t&&oe(t)}}catch(t){console.error("Erro ao buscar pessoas:",t)}finally{ie(!1)}},Ee=()=>{K(""),Q(""),$(""),y([]),Y(""),Z(""),F(""),z(""),ee(""),T(""),_(""),q(""),te(""),ae(null),X(!1),C(null)},Le=()=>{if(!Se){o&&o("error","Sem permissão para criar cidadãos.");return}Ee(),X(!1),v("form")},re=()=>{Ee(),i(null),v("list"),E&&E()},De=t=>{if(a&&m){m(t);return}i(t),v("details")},Oe=()=>{if(l){if(!Se){o&&o("error","Sem permissão para editar.");return}K(l.nome||""),Q(l.sobrenome||""),$(l.email||""),Y(O(l.telefone||"")),Z(Ae(l.cep||"")),F(l.logradouro||""),z(l.numero||""),ee(l.complemento||""),T(l.bairro||""),_(l.cidade||""),q(l.estado||""),te(l.observacoes||""),ae(l),X(!0),v("form"),i(null)}},Re=async()=>{if(A)return;const t=U(B);if(t){if(t.length<10){C("Telefone inválido");return}ve(!0);try{if(L()&&x){const{data:r}=await x.from("citizens").select("*").eq("telefone",t).maybeSingle();r&&(ae(r),o&&o("error","Este telefone já possui cadastro."))}}catch(r){console.error(r)}finally{ve(!1)}}},Ve=async()=>{const t=I.replace(/\D/g,"");if(t.length===8){be(!0);try{const d=await(await fetch(`https://viacep.com.br/ws/${t}/json/`)).json();d.erro||(F(d.logradouro),T(d.bairro),_(d.localidade),q(d.uf))}catch(r){console.error(r)}finally{be(!1)}}},Je=t=>{if($(t),!t){y([]);return}const r=["gmail.com","hotmail.com","outlook.com","yahoo.com.br","icloud.com"];if(r.some(d=>t.endsWith("@"+d))){y([]);return}if(!t.includes("@"))y(r.map(d=>`${t}@${d}`));else{const[d,u]=t.split("@"),p=r.filter(S=>S.startsWith(u));p.length>0?y(p.map(S=>`${d}@${S}`)):y([])}},Xe=t=>{$(t),y([])},Ge=async t=>{t.preventDefault();const r=B?U(B):null,d=I?U(I):null;if(!r){C("É necessário informar o Telefone."),o&&o("error","Telefone obrigatório");return}if(r.length<10){C("Telefone inválido"),o&&o("error","Telefone inválido");return}ye(!0),C(null);try{if(L()&&x){const u={nome:ce,sobrenome:xe,email:he||null,telefone:r,cep:d,logradouro:ue||null,numero:pe||null,complemento:fe||null,bairro:ge||null,cidade:we||null,estado:ke||null,observacoes:je||null};if(A&&(H!=null&&H.id)){const{error:p}=await x.from("citizens").update(u).eq("id",H.id);if(p)throw p;o&&o("success","Cidadão atualizado com sucesso!")}else{const{data:p}=await x.from("citizens").select("id").eq("telefone",r).maybeSingle();if(p)throw new Error("Já existe um cidadão com este telefone.");const{error:S}=await x.from("citizens").insert(u);if(S)throw S;o&&o("success","Cidadão cadastrado com sucesso!")}await se(),j&&j(),re()}}catch(u){C(u.message),o&&o("error",u.message)}finally{ye(!1)}},le=N.filter(t=>{const r=V.toLowerCase(),d=t.nome.toLowerCase().includes(r)||t.sobrenome&&t.sobrenome.toLowerCase().includes(r)||t.telefone&&t.telefone.includes(V)||t.email&&t.email.toLowerCase().includes(r);if(G){const u=n.some(p=>p.citizenId===t.id);return d&&u}return d}),Ke=Math.ceil(le.length/P),Pe=le.slice((J-1)*P,J*P);return c==="details"&&l?e.jsx(ct,{citizen:{...l,id:l.id||"",phone:l.telefone||"",email:l.email||"",name:`${l.nome} ${l.sobrenome}`},onClose:()=>{i(null),v("list")},onEdit:Oe,onCreateDemand:()=>w&&w(l.id||""),onNotification:o,onSelectDemand:t=>{k&&k(t)}}):c==="form"?e.jsxs("div",{className:"flex flex-col h-full animate-in fade-in slide-in-from-right duration-300",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-6 shrink-0",children:[e.jsx("button",{onClick:re,className:"p-2 rounded-xl hover:bg-slate-200 dark:hover:bg-white/10 text-slate-500 dark:text-white transition-colors",children:e.jsx(Fe,{className:"w-6 h-6"})}),e.jsx("h2",{className:"text-2xl font-bold text-slate-900 dark:text-white",children:A?"Editar Cidadão":"Novo Cidadão"})]}),e.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar p-1",children:e.jsxs("form",{onSubmit:Ge,className:"max-w-4xl mx-auto space-y-8 pb-20",children:[e.jsxs("div",{className:"glass-panel p-6 rounded-3xl border border-slate-200 dark:border-white/10 space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-2 text-brand-600 dark:text-brand-400 font-bold uppercase text-xs tracking-wider border-b border-slate-100 dark:border-white/5 pb-2",children:[e.jsx(de,{className:"w-4 h-4"})," Dados Pessoais"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-xs font-bold uppercase text-slate-500 dark:text-white/50",children:"Nome *"}),e.jsx("input",{type:"text",value:ce,onChange:t=>K(t.target.value),className:"w-full px-4 py-3 rounded-xl bg-slate-50 dark:bg-black/20 border border-slate-200 dark:border-white/10 outline-none focus:border-brand-500 transition-all font-medium text-slate-900 dark:text-white",placeholder:"Nome",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-xs font-bold uppercase text-slate-500 dark:text-white/50",children:"Sobrenome"}),e.jsx("input",{type:"text",value:xe,onChange:t=>Q(t.target.value),className:"w-full px-4 py-3 rounded-xl bg-slate-50 dark:bg-black/20 border border-slate-200 dark:border-white/10 outline-none focus:border-brand-500 transition-all font-medium text-slate-900 dark:text-white",placeholder:"Sobrenome"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-xs font-bold uppercase text-slate-500 dark:text-white/50",children:"Celular (WhatsApp) *"}),e.jsx("input",{type:"tel",value:B,onChange:t=>Y(O(t.target.value)),onBlur:Re,className:`w-full px-4 py-3 rounded-xl bg-slate-50 dark:bg-black/20 border ${Ce&&Ce.includes("Telefone")?"border-red-500":"border-slate-200 dark:border-white/10"} outline-none focus:border-brand-500 transition-all font-medium text-slate-900 dark:text-white`,placeholder:"(00) 00000-0000",required:!0})]}),e.jsxs("div",{className:"space-y-2 relative",children:[e.jsx("label",{className:"text-xs font-bold uppercase text-slate-500 dark:text-white/50",children:"Email"}),e.jsx("input",{type:"email",value:he,onChange:t=>Je(t.target.value),className:"w-full px-4 py-3 rounded-xl bg-slate-50 dark:bg-black/20 border border-slate-200 dark:border-white/10 outline-none focus:border-brand-500 transition-all font-medium text-slate-900 dark:text-white",placeholder:"exemplo@email.com"}),me.length>0&&e.jsx("div",{className:"absolute top-full left-0 right-0 mt-1 bg-white dark:bg-slate-800 border border-slate-200 dark:border-white/10 rounded-xl shadow-lg z-10 overflow-hidden",children:me.map(t=>e.jsx("button",{type:"button",onClick:()=>Xe(t),className:"w-full text-left px-4 py-2 hover:bg-slate-50 dark:hover:bg-white/5 text-sm text-slate-700 dark:text-white transition-colors",children:t},t))})]})]})]}),e.jsxs("div",{className:"glass-panel p-6 rounded-3xl border border-slate-200 dark:border-white/10 space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-2 text-brand-600 dark:text-brand-400 font-bold uppercase text-xs tracking-wider border-b border-slate-100 dark:border-white/5 pb-2",children:[e.jsx(_e,{className:"w-4 h-4"})," Endereço"]}),e.jsxs("div",{className:"grid grid-cols-12 gap-4",children:[e.jsxs("div",{className:"col-span-12 sm:col-span-4 space-y-2",children:[e.jsx("label",{className:"text-xs font-bold uppercase text-slate-500 dark:text-white/50",children:"CEP"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",value:I,onChange:t=>Z(Ae(t.target.value)),onBlur:Ve,className:"w-full pl-4 pr-10 py-3 rounded-xl bg-slate-50 dark:bg-black/20 border border-slate-200 dark:border-white/10 outline-none focus:border-brand-500 transition-all font-medium text-slate-900 dark:text-white",placeholder:"00000-000"}),Ue?e.jsx(W,{className:"absolute right-3 top-3 w-5 h-5 text-brand-500 animate-spin"}):e.jsx($e,{className:"absolute right-3 top-3 w-5 h-5 text-slate-400"})]})]}),e.jsxs("div",{className:"col-span-12 sm:col-span-8 space-y-2",children:[e.jsx("label",{className:"text-xs font-bold uppercase text-slate-500 dark:text-white/50",children:"Cidade"}),e.jsx("input",{type:"text",value:we,onChange:t=>_(t.target.value),className:"w-full px-4 py-3 rounded-xl bg-slate-50 dark:bg-black/20 border border-slate-200 dark:border-white/10 outline-none focus:border-brand-500 transition-all font-medium text-slate-900 dark:text-white"})]}),e.jsxs("div",{className:"col-span-12 sm:col-span-9 space-y-2",children:[e.jsx("label",{className:"text-xs font-bold uppercase text-slate-500 dark:text-white/50",children:"Logradouro"}),e.jsx("input",{type:"text",value:ue,onChange:t=>F(t.target.value),className:"w-full px-4 py-3 rounded-xl bg-slate-50 dark:bg-black/20 border border-slate-200 dark:border-white/10 outline-none focus:border-brand-500 transition-all font-medium text-slate-900 dark:text-white"})]}),e.jsxs("div",{className:"col-span-4 sm:col-span-3 space-y-2",children:[e.jsx("label",{className:"text-xs font-bold uppercase text-slate-500 dark:text-white/50",children:"Número"}),e.jsx("input",{type:"text",value:pe,onChange:t=>z(t.target.value),className:"w-full px-4 py-3 rounded-xl bg-slate-50 dark:bg-black/20 border border-slate-200 dark:border-white/10 outline-none focus:border-brand-500 transition-all font-medium text-slate-900 dark:text-white"})]}),e.jsxs("div",{className:"col-span-8 sm:col-span-8 space-y-2",children:[e.jsx("label",{className:"text-xs font-bold uppercase text-slate-500 dark:text-white/50",children:"Bairro"}),e.jsx("input",{type:"text",value:ge,onChange:t=>T(t.target.value),className:"w-full px-4 py-3 rounded-xl bg-slate-50 dark:bg-black/20 border border-slate-200 dark:border-white/10 outline-none focus:border-brand-500 transition-all font-medium text-slate-900 dark:text-white"})]}),e.jsxs("div",{className:"col-span-4 sm:col-span-4 space-y-2",children:[e.jsx("label",{className:"text-xs font-bold uppercase text-slate-500 dark:text-white/50",children:"UF"}),e.jsx("input",{type:"text",value:ke,onChange:t=>q(t.target.value),className:"w-full px-4 py-3 rounded-xl bg-slate-50 dark:bg-black/20 border border-slate-200 dark:border-white/10 outline-none focus:border-brand-500 transition-all font-medium text-slate-900 dark:text-white uppercase",maxLength:2})]}),e.jsxs("div",{className:"col-span-12 space-y-2",children:[e.jsx("label",{className:"text-xs font-bold uppercase text-slate-500 dark:text-white/50",children:"Complemento"}),e.jsx("input",{type:"text",value:fe,onChange:t=>ee(t.target.value),className:"w-full px-4 py-3 rounded-xl bg-slate-50 dark:bg-black/20 border border-slate-200 dark:border-white/10 outline-none focus:border-brand-500 transition-all font-medium text-slate-900 dark:text-white"})]})]})]}),e.jsxs("div",{className:"glass-panel p-6 rounded-3xl border border-slate-200 dark:border-white/10 space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-2 text-brand-600 dark:text-brand-400 font-bold uppercase text-xs tracking-wider border-b border-slate-100 dark:border-white/5 pb-2",children:[e.jsx(Te,{className:"w-4 h-4"})," Informações Adicionais"]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-xs font-bold uppercase text-slate-500 dark:text-white/50",children:"Observações"}),e.jsx("textarea",{value:je,onChange:t=>te(t.target.value),rows:4,className:"w-full px-4 py-3 rounded-xl bg-slate-50 dark:bg-black/20 border border-slate-200 dark:border-white/10 outline-none focus:border-brand-500 transition-all font-medium text-slate-900 dark:text-white resize-none",placeholder:"Anotações gerais sobre o cidadão..."})]})]}),e.jsxs("div",{className:"flex gap-4 pt-4",children:[e.jsx("button",{type:"button",onClick:re,className:"flex-1 py-4 rounded-xl border border-slate-200 dark:border-white/10 font-bold text-slate-600 dark:text-white hover:bg-slate-50 dark:hover:bg-white/5 transition-colors",children:"Cancelar"}),e.jsxs("button",{type:"submit",disabled:Ne,className:"flex-[2] py-4 bg-brand-600 hover:bg-brand-500 text-white rounded-xl font-bold shadow-lg shadow-brand-500/20 flex items-center justify-center gap-2 disabled:opacity-70 transition-all",children:[Ne?e.jsx(W,{className:"w-5 h-5 animate-spin"}):e.jsx(lt,{className:"w-5 h-5"}),A?"Salvar Alterações":"Cadastrar Cidadão"]})]})]})})]}):e.jsxs("div",{className:"flex flex-col h-full animate-in fade-in slide-in-from-left duration-300",children:[e.jsxs("div",{className:"flex flex-col gap-4 mb-4 shrink-0",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[e.jsx("div",{children:e.jsxs("h1",{className:"text-3xl font-bold text-slate-900 dark:text-white tracking-tight flex items-center gap-3",children:[e.jsx(de,{className:"w-8 h-8 text-brand-600 dark:text-brand-400"}),"Base de Cidadãos"]})}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>it(N.map(t=>[t.nome,t.sobrenome,t.telefone,t.bairro,t.cidade]),["Nome","Sobrenome","Telefone","Bairro","Cidade"],"cidadaos"),className:"p-3 rounded-xl bg-slate-100 dark:bg-white/5 text-slate-600 dark:text-white hover:bg-slate-200 dark:hover:bg-white/10 transition-colors border border-slate-200 dark:border-white/10",title:"Exportar CSV",children:e.jsx(dt,{className:"w-5 h-5"})}),e.jsxs("button",{onClick:Le,className:"px-5 py-2.5 bg-brand-600 hover:bg-brand-500 text-white rounded-xl font-bold shadow-lg shadow-brand-500/20 flex items-center gap-2 active:scale-95 transition-all",children:[e.jsx(Be,{className:"w-5 h-5"})," Novo Cadastro"]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"relative flex-1 group",children:[e.jsx($e,{className:"w-5 h-5 text-slate-400 absolute left-3 top-3 group-focus-within:text-brand-500 transition-colors"}),e.jsx("input",{type:"text",value:V,onChange:t=>ne(t.target.value),placeholder:"Buscar por nome, telefone ou email...",className:"w-full pl-10 pr-4 py-3 bg-white/50 dark:bg-black/20 border border-slate-200 dark:border-white/10 rounded-xl outline-none focus:border-brand-500 transition-all font-medium text-slate-900 dark:text-white"}),We&&e.jsx(W,{className:"absolute right-3 top-3 w-5 h-5 text-brand-500 animate-spin"})]}),e.jsxs("button",{onClick:()=>Me(!G),className:`px-4 py-2.5 rounded-xl border flex items-center gap-2 text-sm font-bold transition-all ${G?"bg-brand-50 border-brand-200 text-brand-700 dark:bg-brand-500/20 dark:border-brand-500/30 dark:text-brand-300":"bg-white/50 dark:bg-white/5 border-slate-200 dark:border-white/10 text-slate-500 dark:text-white/60"}`,children:[e.jsx(ot,{className:"w-4 h-4"})," Com Demandas"]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 mb-4 shrink-0",children:[e.jsx(M,{title:"Total Cadastros",value:N.length,icon:de,colorClass:"bg-blue-500",textClass:"text-blue-600 dark:text-blue-400"}),e.jsx(M,{title:"Novos Hoje",value:N.filter(t=>new Date(t.created_at||"").toDateString()===new Date().toDateString()).length,icon:Be,colorClass:"bg-green-500",textClass:"text-green-600 dark:text-green-400"}),e.jsx(M,{title:"Com Demandas",value:N.filter(t=>n.some(r=>r.citizenId===t.id)).length,icon:Ie,colorClass:"bg-purple-500",textClass:"text-purple-600 dark:text-purple-400"}),e.jsx(M,{title:"Com WhatsApp",value:N.filter(t=>t.telefone).length,icon:Ie,colorClass:"bg-green-500",textClass:"text-green-600 dark:text-green-400"})]}),e.jsxs("div",{className:"flex-1 min-h-0 bg-white/50 dark:bg-slate-900/50 rounded-3xl border border-slate-200 dark:border-white/10 overflow-hidden flex flex-col shadow-sm",children:[e.jsxs("div",{className:"flex-1 overflow-y-auto custom-scrollbar relative",children:[qe&&e.jsx("div",{className:"absolute inset-0 bg-white/60 dark:bg-slate-900/60 backdrop-blur-sm z-10 flex items-center justify-center",children:e.jsx(W,{className:"w-8 h-8 animate-spin text-brand-500"})}),e.jsxs("table",{className:"w-full text-left border-collapse",children:[e.jsx("thead",{className:"sticky top-0 bg-slate-50/90 dark:bg-slate-900/90 backdrop-blur-md z-10 shadow-sm",children:e.jsxs("tr",{className:"border-b border-slate-200 dark:border-white/10 text-xs font-bold text-slate-500 dark:text-blue-200/50 uppercase tracking-wider",children:[e.jsx("th",{className:"p-4 pl-6",children:"Nome / Contato"}),e.jsx("th",{className:"p-4 hidden md:table-cell",children:"Endereço"}),e.jsx("th",{className:"p-4 hidden lg:table-cell",children:"Cadastro"}),e.jsx("th",{className:"p-4 text-center",children:"Demandas"}),e.jsx("th",{className:"p-4 pr-6 text-right",children:"Ação"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-200 dark:divide-white/5 text-sm",children:Pe.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"p-8 text-center text-slate-400 dark:text-white/40 italic",children:"Nenhum cidadão encontrado."})}):Pe.map(t=>{const r=n.some(d=>d.citizenId===t.id);return e.jsxs("tr",{className:"hover:bg-white/60 dark:hover:bg-white/5 transition-colors group cursor-pointer",onClick:()=>De(t),children:[e.jsx("td",{className:"p-4 pl-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-brand-100 dark:bg-brand-500/20 text-brand-600 dark:text-brand-400 flex items-center justify-center font-bold text-lg border border-brand-200 dark:border-brand-500/30 shrink-0",children:t.nome.charAt(0)}),e.jsxs("div",{children:[e.jsxs("div",{className:"font-bold text-slate-900 dark:text-white",children:[t.nome," ",t.sobrenome]}),e.jsx("div",{className:"text-xs text-slate-500 dark:text-white/50 font-mono",children:O(t.telefone||"")})]})]})}),e.jsxs("td",{className:"p-4 hidden md:table-cell",children:[e.jsx("div",{className:"text-slate-700 dark:text-white/80",children:t.bairro||"-"}),e.jsx("div",{className:"text-xs text-slate-500 dark:text-white/50",children:t.cidade})]}),e.jsx("td",{className:"p-4 hidden lg:table-cell text-slate-500 dark:text-white/50",children:new Date(t.created_at||"").toLocaleDateString()}),e.jsx("td",{className:"p-4 text-center",children:r?e.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200",children:"Sim"}):e.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-slate-100 text-slate-800 dark:bg-slate-700 dark:text-slate-300",children:"Não"})}),e.jsx("td",{className:"p-4 pr-6 text-right",children:e.jsx("button",{className:"p-2 bg-white dark:bg-white/5 border border-slate-200 dark:border-white/10 rounded-xl text-slate-400 hover:text-brand-600 hover:border-brand-200 dark:hover:border-brand-500/50 transition-colors",children:e.jsx(nt,{className:"w-4 h-4"})})})]},t.id)})})]})]}),e.jsx("div",{className:"bg-slate-50/80 dark:bg-slate-900/80 border-t border-slate-200 dark:border-white/10 shrink-0",children:e.jsx(Ye,{currentPage:J,totalPages:Ke,onPageChange:He,totalItems:le.length,itemsPerPage:P})})]})]})};export{ut as default};
